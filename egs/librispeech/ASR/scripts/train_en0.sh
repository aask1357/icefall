model="ema_limit_customquant"
exp="en/scratch/a8w4_omnicorrect_lin5e-3"

CUDA_VISIBLE_DEVICES=4,5,6,7 ${model}/train.py \
    --world-size 4 \
    --num-epochs 200 \
    --start-epoch 1 \
    --exp-dir exp/$exp \
    --full-libri 1 \
    --max-duration 2400 \
    --master-port 54324 \
    --use-fp16 True \
    --channels 256 \
    --channels-expansion 1024 \
    --dilations-version 11 \
    --kernel-size 8 \
    --encoder-activation ReLU \
    --encoder-se-activation ReLU \
    --skip residual-zeroinit \
    --se-gate tanh \
    --ema-gamma 0.97 \
    --chunksize 8 \
    --encoder-dim 512 \
    --decoder-dim 256 \
    --joiner-dim 256 \
    --encoder-dropout 0.075 \
    --eps 1.0e-5 \
    --n-bits-act 8 \
    --n-bits-weight 4 \
    --quantizer-mode omni_max \
    --quantizer-gamma 0.95 \
    --weight-limit 0.3 \
    --data-libri-train True \
    --data-libri-dev-clean True \
    --data-libri-dev-other True \
    --data-ksponspeech-train False \
    --data-ksponspeech-dev False \
    --data-zeroth-train False \
    --data-zeroth-test False \
    --data-command-nor-train False \
    --data-freetalk-nor-train False \
    --on-the-fly-feats False \
    --bpe-model data/en/lang_bpe_500/bpe.model \
    --manifest-dir data/en/fbank \
    --cutset-text text \
    --num-workers 2 \
    --simple-loss-scale 0.5 \
    --optimizer-name Eve \
    --weight-decay 0.001 \
    --scheduler-name LinearWarmupLR \
    --lr-warmup-iterations 0 \
    --lr-eta-min 1.0e-4 \
    --min-utt-duration 1.0 \
    --max-utt-duration 20.0
